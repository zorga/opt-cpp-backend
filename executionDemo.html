<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Access-Control-Allow-Origin" content="*"/>
</head>
<body>

<h1>Execution steps browser</h1>

<!-- Include required JS files for code highlighting -->
<script type="text/javascript" src="/home/nico/coding/js/syntaxhighlighter_3.0.83/scripts/shCore.js"></script>
<!-- JS file for C and C++ code highlighting -->
<script type="text/javascript" src="/home/nico/coding/js/syntaxhighlighter_3.0.83/scripts/shBrushCpp.js"></script>
<!-- Include the core style and default theme for SyntaxHighlighter -->
<link href="/home/nico/coding/js/syntaxhighlighter_3.0.83/styles/shCore.css" rel="stylesheet" type="text/css" />
<link href="/home/nico/coding/js/syntaxhighlighter_3.0.83/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
<!-- Include the required files for CodeMirror (codemirror.net) -->
<script src="/home/nico/coding/CodeMirror/lib/codemirror.js"></script>
<link rel="stylesheet" href="/home/nico/coding/CodeMirror/lib/codemirror.css">
<script src="/home/nico/coding/CodeMirror/mode/javascript/javascript.js"></script>

<!-- To actually run the highlighter... -->
<script type="text/javascript">
  SyntaxHighlighter.all()
</script>

<div id="container" style="width:100%;">
  <div id="left" style="float:left; width:50%;"> Your code. </div>
  <div id="right" style="float:right; width:50%;"> Memory state. </div>
<div>

<!-- Get and parse the trace file from the web server inside the INGI network -->
<script type="text/javascript"> 

// Start ajax request from retrieving the trace file from the web server :

function loadTraceFile(callback) {
  var xobj = new XMLHttpRequest();
  xobj.overrideMimeType("application/json");
  xobj.open("GET", "http://localhost/thesis_LinkedList.trace", true);
  xobj.onreadystatechange = function() {
    if (xobj.readyState == 4 && xobj.status == "200") {
      callback(xobj.responseText);
    }
  };
  xobj.send();
}


/*
* 'source' is the string representing the source code of the C program
*/
function displaySourceCode (source) {
  // this display the source code to the page but badly formatted
  var myCodeMirror = CodeMirror(document.getElementById("left"), {
    value: source,
    mode: "javascript",
    readOnly: true,
    lineNumbers: true
  }); 
}

/*
* get the response from the HTTP request and parse the trace (json) file into
* a JS object
* Then we can do whatever whe want with that object beginning by displaying the
* code on the html page
*/
function handleJsonObject() {
  loadTraceFile(function(response) {
    // parse JSON string into object
    var json_object = JSON.parse(response);
    // displaying the source-code by passing the 'code' entry of the trace file
    displaySourceCode(json_object.code);
    // Do something with json_object...
  });
}

/*
* It's only a convention because 'main' functions doesn't exist in JS
*/
function main () {
  //TODO
}

// Calling the 'main' function to start everything !
handleJsonObject();
 

</script>

</body>
</html>
